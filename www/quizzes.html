<!DOCTYPE html>

<html lang="en">

<head>

	<meta charset="UTF-8">

	<meta name="viewport" content="width=device-width, initial-scale=1">

<!--===============================================================================================-->	

	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="fonts/Linearicons-Free-v1.0.0/icon-font.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">

<!--===============================================================================================-->	

	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">

<!--===============================================================================================-->	

	<link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">

<!--===============================================================================================-->

	<link rel="stylesheet" type="text/css" href="css/util.css">
	
	<link rel="stylesheet" type="text/css" href= "css/main.css">

<!--===============================================================================================-->
	<meta charset="utf-8" />
	<script src="js/jquery-1.4.4.min.js"></script>
	<script src="https://apis.google.com/js/api.js"></script>
	<script src="https://apis.google.com/js/client.js"></script>
	
	
</head>

<body>
	
	
	<div class="limiter">

		<div class="container" id ="containertest">

			<img src="img/blob.png">
			
			<h1 class = "quizheading">Quizzes</h1>

			<!--<i class="zmdi zmdi-assignment zmdi-hc-4x"></i>-->

		</div>

	</div>
	
	<script defer type = "text/javascript">
		var points = 0
		// Client ID and API key from the Developer Console
        	var CLIENT_ID = '607367220939-vnonmb2l7t3l5r4337kak4oj2t13iunq.apps.googleusercontent.com';
      		var API_KEY = '	AIzaSyBx2kIQQJOGj9LxZeuN04nQLTL9grrAaHg';

	        // Array of API discovery doc URLs for APIs used by the quickstart
	        var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

	      // Authorization scopes required by the API; multiple scopes can be
	      // included, separated by spaces.
	      var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        console.log("test1");
        gapi.load('client:auth2',initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
	console.log("help");
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () {
              //See if calling API directly will work. Google documentation seems to always suggest using sign in
              listMajors();
              console.log("listmajors");
        });
      }

      /**
       * APPENDPRE IS A FUNCTION USED TO PRINT TO DOCUMENT
       *
       * @param {string} message Text to be placed in pre element.
       */
       function createquestion(question,range){
           var quizlabel = document.createElement("h1");
	   quizlabel.value = question;
	   quizlabel.className = "quizheading";
	   var textNode = document.createTextNode(question);
	   quizlabel.appendChild(textNode);
	   var division = document.getElementsByClassName("container")[0];
	   division.appendChild(quizlabel);
       }
       function createanswer(optionval,header,range,questionnumber){
	   var option = document.createElement("button");
	   option.className = "quizmenubtn";   
	   var optionrow = range[optionval+header];
	   console.log(optionrow);
	   var answer = optionrow[questionnumber];
	   var textNode = document.createTextNode(answer);
	   option.appendChild(textNode);
	   var container = document.getElementsByClassName("container")[0];
	   container.appendChild(option);
	   option.addEventListener("click",function(){
		   var answercheckrow = range[header+5];
		   var answercheck = answercheckrow[questionnumber];
		   if (optionval === answercheck){
			   console.log("Answer was correct!");
			   points++;
		   }
		   else{
			   console.log("Answer was incorrect");
		   }
		   nextquestion(header,questionnumber+1)});
       }
       function nextquestion(header,number){
	    console.log("button clicked");
            var menubuttons = document.getElementsByClassName("quizmenubtn");
	    for (var i = 0; i = (menubuttons.length)-1; i++){
	    	menubuttons[i].parentNode.removeChild(menubuttons[i]);
	    }
	    var quiztitles = document.getElementsByClassName("quizheading");
	    for (var j = 0; j = (quiztitles.length)-1; i++){
	    	quiztitles[i].parentNode.removeChild(quiztitles[i]);
	    }
	    //menubuttons.remove();
	    gapi.client.sheets.spreadsheets.values.get({
            	spreadsheetId: '1bJvqu2n2Tfsf91vRqMsrwYdyh31wBCyJ9qU-usbWeOk',
          	range: 'B1:M30',
            }).then(function(response) {
	    	var range = response.result;
          	if (range.values.length > 0) {
			var row = range.values[header];
			var question = row[number];
			createquestion(question,range.values,number);
			createanswer(1,header,range.values,number);
			createanswer(2,header,range.values,number);
			createanswer(3,header,range.values,number);
			createanswer(4,header,range.values,number);
		} else {
		    console.log('No data found.');
		}	    
	    }, function(response) {
            	console.log('Error: ' + response.result.error.message);
            });
            }  

      function appendPre(message,header) {
        var pre = document.createElement("button");
	var textnode = document.createTextNode(message);
	pre.appendChild(textnode);
	pre.className = "quizmenubtn";
	var division = document.body.getElementsByClassName("container")[0];
	division.appendChild(pre);
	console.log("Button created");
	pre.addEventListener("click",function(){nextquestion(header,1)});
      }
      /**
       * Print the names and majors of students in a sample spreadsheet:
       * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
       */
      function listMajors() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1bJvqu2n2Tfsf91vRqMsrwYdyh31wBCyJ9qU-usbWeOk',
          range: 'B1:M30',
        }).then(function(response) {
          console.log('lol');
          var range = response.result;
          if (range.values.length > 0) {
            for (i = 0; i < range.values.length; i++) {
              var row = range.values[i];
              // Print columns A and E, which correspond to indices 0 and 4.
	      console.log(row[0])
		    if (typeof row[0] !== "undefined"){
		      var cellheader = row[0].slice(0,4);
		      if (cellheader === "Quiz"){
			    appendPre(row[0].slice(4,),i);
		      }
	   	    }
            }
          } else {
            console.log('No data found.');
          }
        }, function(response) {
          console.log('Error: ' + response.result.error.message);
        });
         }</script>
	
	 <script defer src="https://apis.google.com/js/api.js"
	      onload="this.onload=function(){};handleClientLoad()"
	      onreadystatechange="if (this.readyState === 'complete') this.onload()">
	 </script>
	
	<!--<script defer src="https://apis.google.com/js/api.js" onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()"></script>-->
<!--===============================================================================================-->

	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>

<!--===============================================================================================-->

	<script src="vendor/animsition/js/animsition.min.js"></script>

<!--===============================================================================================-->

	<script src="vendor/bootstrap/js/popper.js"></script>

	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

<!--===============================================================================================-->

	<script src="vendor/select2/select2.min.js"></script>

<!--===============================================================================================-->

	<script src="vendor/daterangepicker/moment.min.js"></script>

	<script src="vendor/daterangepicker/daterangepicker.js"></script>

<!--===============================================================================================-->

	<script src="vendor/countdowntime/countdowntime.js"></script>

<!--===============================================================================================-->
	
	<script defer src="js/main.js"></script>


</body>

</html>
